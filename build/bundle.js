module.exports=function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=79)}([function(t,e,r){t.exports.ArgumentError=r(33),t.exports.ForbiddenError=r(34),t.exports.HookTokenError=r(35),t.exports.ManagementApiError=r(36),t.exports.NotFoundError=r(37),t.exports.UnauthorizedError=r(38),t.exports.ValidationError=r(39)},function(t,e,r){t.exports.ArgumentError=r(61),t.exports.ForbiddenError=r(62),t.exports.HookTokenError=r(63),t.exports.ManagementApiError=r(64),t.exports.NotFoundError=r(65),t.exports.UnauthorizedError=r(66),t.exports.ValidationError=r(67)},function(t,e){t.exports=require("bluebird")},function(t,e,r){const n=r(12),o=r(0),i=r(43),s=t.exports={};s.ArgumentError=o.ArgumentError,s.ForbiddenError=o.ForbiddenError,s.HookTokenError=o.HookTokenError,s.ManagementApiError=o.ManagementApiError,s.NotFoundError=o.NotFoundError,s.UnauthorizedError=o.UnauthorizedError,s.ValidationError=o.ValidationError,s.managementApi=r(29),s.FileStorageContext=i.FileStorageContext,s.WebtaskStorageContext=i.WebtaskStorageContext,s.BlobRecordProvider=r(30),s.config=r(31),s.configProvider=r(14),s.createServer=r(32).createServer,s.validateHookToken=r(45),s.SessionManager=r(41),s.createExpressServer=function(t){return n.fromExpress(s.createServer(t))},s.createHapiServer=function(t){return n.fromHapi(s.createServer(t))}},function(t,e){t.exports=require("lodash")},function(t,e){t.exports=require("jsonwebtoken")},function(t,e,r){"use strict";t.exports=r(17).config()},function(t,e,r){const n=r(56),o=r(15),i=r(49),s=r(55);t.exports.createServer=n.createServer,t.exports.urlHelpers=o,t.exports.middlewares=i,t.exports.routes=s},function(t,e){t.exports=require("superagent")},function(t,e){t.exports=require("crypto")},function(t,e){t.exports=require("express")},function(t,e){t.exports=require("jwks-rsa@1.1.1")},function(t,e){t.exports=require("webtask-tools")},function(t,e,r){"use strict";var n=r(96);n.emitErrs=!0;var o=new n.Logger({transports:[new n.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});t.exports=o,t.exports.stream={write:function(t){o.info(t.replace(/\n$/,""))}}},function(t,e,r){const n=r(4),o=r(0).ArgumentError;t.exports.fromWebtaskContext=function(t){if(null===t||void 0===t)throw new o("Must provide a webtask context");const e={AUTH0_RTA:"auth0.auth0.com"},i=n.assign(e,r.i({NODE_ENV:"production",CLIENT_VERSION:"2.4.6"}),t.params,t.secrets,{NODE_ENV:"production",HOSTING_ENV:"webtask"});return function(t){return i[t]}}},function(t,e,r){function n(t){if(!t.container)return null;const e=t.container.replace(a,"\\$&"),r=t.jtn?t.jtn.replace(a,"\\$&"):"";if(t.url_format===c)return new RegExp("^/api/run/"+e+"/(?:"+r+"/?)?");if(t.url_format===u)return new RegExp("^/"+e+"/(?:"+r+"/?)?");if(t.url_format===s)return new RegExp("^/(?:"+r+"/?)?");throw new Error("Unsupported webtask URL format.")}function o(t,e){if(!t)return null;const r=t.indexOf("sandbox8")>=0?"8":"";return"https://"+e+"."+(t.split(".it.auth0.com")[0].split("-")[1]||"us")+r+".webtask.io/"}const i=r(95),s=3,u=2,c=1,a=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,p=function(t,e){var r=i.parse(t).pathname||"";return r=r.replace(e,"").replace(/^\/|\/$/g,""),r.startsWith("/")||(r="/"+r),r.endsWith("/")||(r+="/"),r};t.exports.getBasePath=function(t){return p(t.originalUrl||"",t.path)},t.exports.getBaseUrl=function(t,e){var r=e;const n=i.parse(t.originalUrl||"").pathname||"";return i.format({protocol:r||"https",host:t.headers.host,pathname:n.replace(t.path,"").replace(/\/$/g,"")})},t.exports.getWebtaskUrl=function(t){const e=n(t.x_wt),r=t.url,s=t.url.replace(e,"/"),u=i.parse(s||"").pathname,c=t.x_wt&&t.x_wt.ectx&&t.x_wt.ectx.ISOLATED_DOMAIN||!1,a=i.parse(r||"").pathname||"";var p;if(c){p=i.format({protocol:"https",host:t.headers.host,pathname:a.replace(u,"").replace(/\/$/g,"")});const d=".it.auth0.com/api/run/"+t.x_wt.container+"/",f=o(p,t.x_wt.container);p.indexOf(d)>=0&&(p=p.replace("https://"+t.headers.host+"/api/run/"+t.x_wt.container+"/",f))}else p=a;return p}},function(t,e,r){const n=r(4),o=r(1).ArgumentError;t.exports.fromWebtaskContext=function(t){if(null===t||void 0===t)throw new o("Must provide a webtask context");const e={AUTH0_RTA:"auth0.auth0.com"},i=n.assign(e,r.i({NODE_ENV:"production",CLIENT_VERSION:"2.4.6"}),t.params,t.secrets,{NODE_ENV:"production",HOSTING_ENV:"webtask"});return function(t){return i[t]}}},function(t,e,r){const n=r(12),o=r(1),i=r(71),s=t.exports={};s.ArgumentError=o.ArgumentError,s.ForbiddenError=o.ForbiddenError,s.HookTokenError=o.HookTokenError,s.ManagementApiError=o.ManagementApiError,s.NotFoundError=o.NotFoundError,s.UnauthorizedError=o.UnauthorizedError,s.ValidationError=o.ValidationError,s.managementApi=r(57),s.FileStorageContext=i.FileStorageContext,s.WebtaskStorageContext=i.WebtaskStorageContext,s.BlobRecordProvider=r(58),s.config=r(59),s.configProvider=r(16),s.createServer=r(60).createServer,s.validateHookToken=r(73),s.SessionManager=r(69),s.createExpressServer=function(t){return n.fromExpress(s.createServer(t))},s.createHapiServer=function(t){return n.fromHapi(s.createServer(t))}},function(t,e,r){"use strict";var n=r(86);t.exports=function(t,e,r){return function(o,i,s){var u=n(s);return!0===t||"function"==typeof t&&t(o,i,u)?e(o,i,u):r?r(o,i,u):u()}}},function(t,e,r){"use strict";var n=r(85);t.exports=function(t,e){if("string"!=typeof t)throw new Error("Invalid token specified");e=e||{};var r=!0===e.header?0:1;return JSON.parse(n(t.split(".")[r]))}},function(t,e,r){"use strict";function n(t){return t&&"EPROMISERETRY"===t.code&&u.call(t,"retried")}function o(t,e){var r,o;return"object"==typeof t&&"function"==typeof e&&(r=e,e=t,t=r),o=s.operation(e),new Promise(function(e,r){o.attempt(function(s){Promise.resolve().then(function(){return t(function(t){throw n(t)&&(t=t.retried),i("Retrying","EPROMISERETRY",{retried:t})},s)}).then(e,function(t){n(t)&&(t=t.retried,o.retry(t||new Error))||r(t)})})})}var i=r(82),s=r(87),u=Object.prototype.hasOwnProperty;t.exports=o},function(t,e){t.exports=require("async")},function(t,e){t.exports=require("auth0@2.1.0")},function(t,e){t.exports=require("express-jwt")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("lru-memoizer")},function(t,e){t.exports=require("ms")},function(t,e){t.exports=require("node-uuid")},function(t,e,r){"use strict";(function(e){var n=r(94),o=r(10),i=r(90),s=r(7),u=r(17),c=r(13),a=r(6),p=r(83),d=r(75),f=r(74);t.exports=function(t,r){a.setProvider(t);var h=r?new u.WebtaskStorageContext(r,{force:1}):new u.FileStorageContext(n.join(e,"./data.json"),{mergeWrites:!0}),l=o();return l.use("/app",o.static(n.join(e,"../build"))),l.use(i.json()),l.use(i.urlencoded({extended:!1})),l.use("/meta",function(t,e){e.status(200).send(p)}),l.use(s.routes.dashboardAdmins({secret:a("EXTENSION_SECRET"),audience:"urn:user-import-export-extension",rta:a("AUTH0_RTA").replace("https://",""),domain:a("AUTH0_DOMAIN"),baseUrl:a("PUBLIC_WT_URL")||a("WT_URL"),clientName:"User Import / Export Extension",urlPrefix:"",sessionStorageKey:"user-import-export-extension:apiToken",scopes:"create:users read:users read:connections create:passwords_checking_job"})),l.use("/api",f(h)),l.get("*",d()),l.use(s.middlewares.errorHandler(c.error.bind(c))),l}}).call(e,"/")},function(t,e,r){const n=r(26),o=r(5),i=r(22),s=r(2),u=r(25),c=r(8),a=r(0).ArgumentError,p=r(0).ManagementApiError,d=function(t,e,r){return new s(function(n,o){c.post("https://"+t+"/oauth/token").send({audience:"https://"+t+"/api/v2/",client_id:e,client_secret:r,grant_type:"client_credentials"}).set("Accept","application/json").end(function(t,r){return t&&401===t.status?o(new p("unauthorized","Invalid credentials for "+e,t.status)):t&&r&&r.body&&r.body.error?o(new p(r.body.error,r.body.error_description||r.body.error,t.status)):t?o(t):r.ok&&r.body.access_token?n(r.body.access_token):o(new p("unknown_error","Unknown error from Management Api or no access token was provided: "+(r.text||r.status)))})})},f=s.promisify(u({load:function(t,e,r,n){d(t,e,r).then(function(t){return n(null,t)}).catch(function(t){return n(t)})},hash:function(t,e,r){return t+"-"+e+"-"+r},itemMaxAge:function(t,e,r,n){try{const i=o.decode(n),s=new Date(0);s.setUTCSeconds(i.exp);const u=(new Date).valueOf();return s.valueOf()-u-1e4}catch(t){return 1e3}},max:100,maxAge:n("1h")}));t.exports.getAccessToken=d,t.exports.getAccessTokenCached=f,t.exports.getClient=function(t){if(null===t||void 0===t)throw new a("An options object must be provided");if(null===t.domain||void 0===t.domain)throw new a("An options object must contain the domain");if("string"!=typeof t.domain||0===t.domain.length)throw new a("The provided domain is invalid: "+t.domain);if(t.accessToken){if("string"!=typeof t.accessToken||0===t.accessToken.length)throw new a("The provided accessToken is invalid");return s.resolve(new i.ManagementClient({domain:t.domain,token:t.accessToken}))}if(null===t.clientId||void 0===t.clientId)throw new a("An options object must contain the clientId");if("string"!=typeof t.clientId||0===t.clientId.length)throw new a("The provided clientId is invalid: "+t.clientId);if(null===t.clientSecret||void 0===t.clientSecret)throw new a("An options object must contain the clientSecret");if("string"!=typeof t.clientSecret||0===t.clientSecret.length)throw new a("The provided clientSecret is invalid");return f(t.domain,t.clientId,t.clientSecret).then(function(e){return new i.ManagementClient({domain:t.domain,token:e})})}},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new c("Must provide a storage context");this.storageContext=t,this.queue=u(),this.options=e||{concurrentWrites:!0}}const o=r(4),i=r(27),s=r(20),u=r(40),c=r(0).ArgumentError,a=r(0).NotFoundError,p=r(0).ValidationError,d=function(t,e){return t.read(e).then(function(t){return t[e]=t[e]||[],t})},f=function(t,e){const r={retries:10,factor:2,minTimeout:100,maxTimeout:1/0,randomize:!1};return function(){return s(function(r){return e().catch(function(e){if((t.writeRetryCondition||function(){return!1})(e))return r(e);throw e})},r)}};n.prototype.write=function(t,e){const r=f(t,e);if(this.options.concurrentWrites)return r();const n=this.queue;return new Promise(function(t,e){n(r,function(r,n){return r?e(r):t(n)})})},n.prototype.getAll=function(t){return d(this.storageContext,t).then(function(e){return e[t]})},n.prototype.get=function(t,e){return this.getAll(t).then(function(r){const n=o.find(r,function(t){return t._id===e});return n||Promise.reject(new a("The record "+e+" in "+t+" does not exist."))})},n.prototype.create=function(t,e){const r=this.storageContext;return this.write(r,function(){return d(r,t).then(function(n){return e._id||(e._id=i.v4()),o.findIndex(n[t],function(t){return t._id===e._id})>-1?Promise.reject(new p("The record "+e._id+" in "+t+" already exists.")):(n[t].push(e),r.write(n).then(function(){return e}))})})},n.prototype.update=function(t,e,r,n){const i=this.storageContext;return this.write(i,function(){return d(i,t).then(function(s){const u=o.findIndex(s[t],function(t){return t._id===e});if(u<0&&!n)throw new a("The record "+e+" in "+t+" does not exist.");const c=o.extend({_id:e},u<0?{}:s[t][u],r);return u<0?s[t].push(c):s[t][u]=c,i.write(s).then(function(){return c})})})},n.prototype.delete=function(t,e){const r=this.storageContext;return this.write(r,function(){return d(r,t).then(function(n){const i=o.findIndex(n[t],function(t){return t._id===e});return!(i<0)&&(n[t].splice(i,1),r.write(n).then(function(){return!0}))})})},t.exports=n},function(t,e){t.exports=function(){const t={};var e=null;const r=function(r){if(t&&t[r])return t[r];if(!e)throw new Error("A configuration provider has not been set");return e(r)};return r.setProvider=function(t){e=t},r.setValue=function(e,r){t[e]=r},r}},function(t,e,r){const n=r(14);t.exports.createServer=function(t){var e=null;return function(r){if(!e){const o=n.fromWebtaskContext(r);e=t(o,r.storage)}return e}}},function(t,e){function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="ArgumentError",this.message=t,this.status=400}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="ForbiddenError",this.message=t,this.status=403}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t,e){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="HookTokenError",this.message=t,this.status=401,this.innerError=e}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t,e,r){Error.call(this,e),Error.captureStackTrace(this,this.constructor),this.name="ManagementApiError",this.code=t,this.message=e,this.status=r||400}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="NotFoundError",this.message=t,this.status=404}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="UnauthorizedError",this.message=t,this.status=401}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e){function r(t){Error.call(this,t),Error.captureStackTrace(this,this.constructor),this.name="ValidationError",this.message=t,this.status=400}r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,t.exports=r},function(t,e,r){const n=r(21);t.exports=function(){const t=n.queue(function(t,e){t().then(function(t){e(null,t)}).catch(function(t){e(t)})},1);return t.push.bind(t)}},function(t,e,r){function n(t,e,r){if(null===t||void 0===t)throw new c("Must provide a valid domain");if("string"!=typeof t||0===t.length)throw new c("The provided rta is invalid: "+t);if(0===t.indexOf("https://")&&(t=t.replace("https://","")),null===e||void 0===e)throw new c("Must provide a valid domain");if("string"!=typeof e||0===e.length)throw new c("The provided domain is invalid: "+e);if(null===r||void 0===r)throw new c("Must provide a valid clientId");if("string"!=typeof r||0===r.length)throw new c("The provided clientId is invalid: "+r);this.options={rta:t,domain:e,clientId:r},this.jwksClient=s({cache:!0,rateLimit:!0,jwksRequestsPerMinute:10,jwksUri:"https://"+t+"/.well-known/jwks.json"}),this.managementApiAudience="https://"+e+"/api/v2/"}const o=r(5),i=r(2),s=r(11),u=r(9),c=r(0).ArgumentError,a=r(0).UnauthorizedError,p=r(0).ValidationError;n.prototype.createAuthorizeUrl=function(t){if(null===t||void 0===t)throw new c("Must provide the options");if(null===t.redirectUri||void 0===t.redirectUri)throw new c("Must provide the redirectUri");if(null===t.nonce||void 0===t.nonce)t.nonce=u.randomBytes(16).toString("hex");else if("string"!=typeof t.nonce||0===t.nonce.length)throw new c("The provided nonce is invalid: "+t.nonce);if("string"!=typeof t.redirectUri||0===t.redirectUri.length)throw new c("The provided redirectUri is invalid: "+t.redirectUri);if(void 0!==t.state&&("string"!=typeof t.state||0===t.state.length))throw new c("The provided state is invalid: "+t.state);var e="openid name email";t.scopes&&t.scopes.length&&(e+=" "+t.scopes);var r=["https://"+this.options.rta+"/authorize","?client_id="+encodeURIComponent(this.options.clientId),"&response_type=token id_token","&response_mode=form_post","&scope="+encodeURIComponent(e),"&expiration="+(t.expiration||36e3),"&redirect_uri="+encodeURIComponent(t.redirectUri),"&audience="+encodeURIComponent(this.managementApiAudience),"&nonce="+encodeURIComponent(t.nonce)];return t.state&&r.push("&state="+encodeURIComponent(t.state)),r.join("")},n.prototype.validateToken=function(t,e,r){const n=this;return new i(function(t,i){const s=o.decode(r,{complete:!0});return null==s?i(new p("Unable to decoded the token.")):n.jwksClient.getSigningKey(s.header.kid,function(s,u){if(s)return i(s);const c=u.publicKey||u.rsaPublicKey;return o.verify(r,c,{algorithms:["RS256"]},function(r,o){return r?i(r):o.iss!=="https://"+n.options.rta+"/"?i(new a("Invalid issuer: "+o.iss)):o&&(o.aud===e||Array.isArray(o.aud)&&o.aud.indexOf(e)>-1)?t(o):i(new a("Audience mismatch for: "+e))})})})},n.prototype.create=function(t,e,r){if(null===t||void 0===t)return i.reject(new c("Must provide an id_token"));if("string"!=typeof t||0===t.length)return i.reject(new c("The provided id_token is invalid: "+t));if(null===e||void 0===e)return i.reject(new c("Must provide an access_token"));if("string"!=typeof e||0===e.length)return i.reject(new c("The provided access_token is invalid: "+e));if(null===r||void 0===r)return i.reject(new c("Must provide the options"));if(null===r.secret||void 0===r.secret)return i.reject(new c("Must provide the secret"));if("string"!=typeof r.secret||0===r.secret.length)return i.reject(new c("The provided secret is invalid: "+r.secret));if(null===r.audience||void 0===r.audience)return i.reject(new c("Must provide the audience"));if("string"!=typeof r.audience||0===r.audience.length)return i.reject(new c("The provided audience is invalid: "+r.audience));if(null===r.issuer||void 0===r.issuer)return i.reject(new c("Must provide the issuer"));if("string"!=typeof r.issuer||0===r.issuer.length)return i.reject(new c("The provided issuer is invalid: "+r.issuer));const n=this;return i.all([n.validateToken(n.options.clientId,n.options.clientId,t),n.validateToken(n.options.clientId,n.managementApiAudience,e)]).then(function(t){if(t[1].azp!==n.options.clientId)return i.reject(new a("The access_token's azp does not match the id_token"));if(t[0].sub!==t[1].sub)return i.reject(new a("Subjects don't match"));const s={sub:t[0].sub,email:t[0].email,exp:t[0].exp,access_token:e};return o.sign(s,r.secret,{algorithm:"HS256",issuer:r.issuer,audience:r.audience})})},t.exports=n},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new u("Must provide the path to the file");if("string"!=typeof t||0===t.length)throw new u("The provided path is invalid: "+t);e=e||{mergeWrites:!0},this.path=t,this.mergeWrites=e.mergeWrites,this.defaultData=e.defaultData||{}}const o=r(4),i=r(24),s=r(2),u=r(0).ArgumentError;n.prototype.read=function(){const t=this;return new s(function(e,r){i.readFile(t.path,"utf8",function(n,o){if(n)return"ENOENT"===n.code?e(t.defaultData):r(n);try{return e(o&&o.length?JSON.parse(o):t.defaultData)}catch(t){return r(t)}})})},n.prototype.write=function(t){const e=this;var r=s.resolve(t);return e.mergeWrites&&(r=r.then(function(t){return e.read().then(function(e){return o.extend({},e,t)})})),r.then(function(t){return new s(function(r,n){try{return i.writeFile(e.path,JSON.stringify(t,null,2),"utf8",function(t){return t?n(t):r()})}catch(t){return n(t)}})})},t.exports=n},function(t,e,r){t.exports.FileStorageContext=r(42),t.exports.WebtaskStorageContext=r(44)},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new i("Must provide the Webtask storage object");e=e||{force:1},this.storage=t,this.options=e,this.defaultData=e.defaultData||{}}const o=r(2),i=r(0).ArgumentError;n.prototype.read=function(){const t=this;return new o(function(e,r){t.storage.get(function(n,o){return n?r(n):e(o||t.defaultData)})})},n.prototype.write=function(t){const e=this;return new o(function(r,n){e.storage.set(t,e.options,function(t){return t?n(t):r()})})},n.prototype.writeRetryCondition=function(t){return 409===t.code},t.exports=n},function(t,e,r){const n=r(5),o=r(0).HookTokenError;t.exports=function(t,e,r,i,s){if(!s)throw new o("Hook token missing");try{return n.verify(s,i,{audience:e+r,issuer:"https://"+t}),!0}catch(t){throw new o("Invalid hook token",t)}}},function(t,e,r){const n=r(19),o=r(23),i=r(3),s=r(18);t.exports=function(t){if(!t||"object"!=typeof t)throw new i.ArgumentError("Must provide the options");if(null===t.secret||void 0===t.secret)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof t.secret||0===t.secret.length)throw new i.ArgumentError("The provided secret is invalid: "+t.secret);if(null===t.audience||void 0===t.audience)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof t.audience||0===t.audience.length)throw new i.ArgumentError("The provided audience is invalid: "+t.audience);if(null===t.baseUrl||void 0===t.baseUrl)throw new i.ArgumentError("Must provide a valid base URL");if("string"!=typeof t.baseUrl||0===t.baseUrl.length)throw new i.ArgumentError("The provided base URL is invalid: "+t.baseUrl);const e=o({audience:t.audience,issuer:t.baseUrl,secret:t.secret,algorithms:["HS256"],credentialsRequired:t.credentialsRequired||!0});return function(r,n,o){e(r,n,function(e){return e?o(e):t.onLoginSuccess?t.onLoginSuccess(r,n,o):o()})}},t.exports.optional=function(e){const r=t.exports(e);return s(function(t){if(t&&t.headers&&t.headers.authorization&&0===t.headers.authorization.indexOf("Bearer "))try{const r=n(t.headers.authorization.split(" ")[1]);return r&&r.iss===e.baseUrl}catch(t){return!1}return!1},r)}},function(t,e,r){const n=r(19),o=r(23),i=r(11),s=r(3),u=r(18),c=r(3).UnauthorizedError;t.exports=function(t){if(!t||"object"!=typeof t)throw new s.ArgumentError("Must provide the options");if(null===t.domain||void 0===t.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof t.domain||0===t.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+t.domain);if(null===t.audience||void 0===t.audience)throw new s.ArgumentError("Must provide a valid audience");if("string"!=typeof t.audience||0===t.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+t.audience);const e=o({secret:i.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+t.domain+"/.well-known/jwks.json",handleSigningKeyError:function(t,e){return e(t instanceof i.SigningKeyNotFoundError?new c("A token was provided with an invalid kid"):t)}}),audience:t.audience,issuer:"https://"+t.domain+"/",algorithms:["RS256"],credentialsRequired:t&&t.credentialsRequired||!0});return function(r,n,o){e(r,n,function(e){return e?o(e):t.onLoginSuccess?t.onLoginSuccess(r,n,o):o()})}},t.exports.optional=function(e){const r=t.exports(e);return u(function(t){if(t&&t.headers&&t.headers.authorization&&0===t.headers.authorization.indexOf("Bearer "))try{const r=n(t.headers.authorization.split(" ")[1]);return r&&r.iss==="https://"+e.domain+"/"}catch(t){return!1}return!1},r)}},function(t,e,r){t.exports=function(t){return function(e,r,n,o){return t&&t(e),e&&e.status?(n.status(e.status),n.json({error:e.code||e.name,message:e.message||e.name})):(n.status(e.status||500),n.json({error:"InternalServerError",message:e.message||e.name}))}}},function(t,e,r){t.exports.authenticateAdmins=r(46),t.exports.authenticateUsers=r(47),t.exports.requireAuthentication=r(51),t.exports.errorHandler=r(48),t.exports.managementApiClient=r(50),t.exports.validateHookToken=r(52),t.exports.webtaskConfig=r(53)},function(t,e,r){const n=r(3);t.exports=function(t){return function(e,r,o){const i=e,s=e.user&&e.user.access_token&&e.user.access_token.length,u=s?{domain:t.domain,accessToken:e.user.access_token}:t;n.managementApi.getClient(u).then(function(t){return i.auth0=t,o(),null}).catch(function(t){o(t)})}}},function(t,e,r){const n=r(3).UnauthorizedError;t.exports=function(t,e,r){return t.user?r():r(new n("Authentication required for this endpoint."))}},function(t,e,r){const n=r(3);t.exports=function(t,e,r){if(null===t||void 0===t)throw new n.ArgumentError("Must provide the domain");if("string"!=typeof t||0===t.length)throw new n.ArgumentError("The provided domain is invalid: "+t);if(null===e||void 0===e)throw new n.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof e||0===e.length)throw new n.ArgumentError("The provided webtaskUrl is invalid: "+e);if(null===r||void 0===r)throw new n.ArgumentError("Must provide the extensionSecret");if("string"!=typeof r||0===r.length)throw new n.ArgumentError("The provided extensionSecret is invalid: "+r);return function(o){if(null===o||void 0===o)throw new n.ArgumentError("Must provide the hookPath");if("string"!=typeof o||0===o.length)throw new n.ArgumentError("The provided hookPath is invalid: "+o);return function(i,s,u){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const c=i.headers.authorization.split(" ")[1];try{if(n.validateHookToken(t,e,o,r,c))return u()}catch(t){return u(t)}}return u(new n.HookTokenError("Hook token missing for the call to: "+o))}}}},function(t,e,r){const n=r(3);t.exports=function(t){return function(e,r,o){return e.webtaskContext&&t.setProvider(n.configProvider.fromWebtaskContext(e.webtaskContext)),o()}}},function(t,e,r){const n=r(10),o=r(9),i=r(80),s=r(5),u=r(3),c=r(15);t.exports=function(t){if(!t||"object"!=typeof t)throw new u.ArgumentError("Must provide the options");if(null===t.secret||void 0===t.secret)throw new u.ArgumentError("Must provide a valid secret");if("string"!=typeof t.secret||0===t.secret.length)throw new u.ArgumentError("The provided secret is invalid: "+t.secret);if(null===t.audience||void 0===t.audience)throw new u.ArgumentError("Must provide a valid audience");if("string"!=typeof t.audience||0===t.audience.length)throw new u.ArgumentError("The provided audience is invalid: "+t.audience);if(null===t.rta||void 0===t.rta)throw new u.ArgumentError("Must provide a valid rta");if("string"!=typeof t.rta||0===t.rta.length)throw new u.ArgumentError("The provided rta is invalid: "+t.rta);if(null===t.domain||void 0===t.domain)throw new u.ArgumentError("Must provide a valid domain");if("string"!=typeof t.domain||0===t.domain.length)throw new u.ArgumentError("The provided domain is invalid: "+t.domain);if(null===t.baseUrl||void 0===t.baseUrl)throw new u.ArgumentError("Must provide a valid base URL");if("string"!=typeof t.baseUrl||0===t.baseUrl.length)throw new u.ArgumentError("The provided base URL is invalid: "+t.baseUrl);if(null===t.clientName||void 0===t.clientName)throw new u.ArgumentError("Must provide a valid client name");if("string"!=typeof t.clientName||0===t.clientName.length)throw new u.ArgumentError("The provided client name is invalid: "+t.clientName);const e=t.stateKey||"state",r=t.nonceKey||"nonce",a=t.urlPrefix||"",p=t.sessionStorageKey||"apiToken",d=n.Router();return d.get(a+"/login",function(n,i){const s=o.randomBytes(16).toString("hex"),p=o.randomBytes(16).toString("hex");i.cookie(e,s),i.cookie(r,p);const d=new u.SessionManager(t.rta,t.domain,t.baseUrl),f=d.createAuthorizeUrl({redirectUri:c.getBaseUrl(n)+a+"/login/callback",scopes:t.scopes,expiration:t.expiration,nonce:p,state:s});i.redirect(f)}),d.post(a+"/login/callback",i(),function(n,o,i){var a;try{a=s.decode(n.body.id_token)}catch(t){a=null}return a?n.cookies&&n.cookies[r]&&n.cookies[r]!==a.nonce?i(new u.ValidationError("Login failed. Nonce mismatch.")):n.cookies&&n.cookies[e]&&n.cookies[e]!==n.body.state?i(new u.ValidationError("Login failed. State mismatch.")):new u.SessionManager(t.rta,t.domain,t.baseUrl).create(n.body.id_token,n.body.access_token,{secret:t.secret,issuer:t.baseUrl,audience:t.audience}).then(function(t){o.header("Content-Type","text/html"),o.status(200).send('<html><head><script type="text/javascript">sessionStorage.setItem("'+p+'", "'+t+'");window.location.href = "'+c.getBaseUrl(n)+'";<\/script></head></html>')}).catch(function(t){i(t)}):i(new u.ValidationError("Login failed. Token invalid."))}),d.get(a+"/logout",function(e,r){const n=encodeURIComponent(c.getBaseUrl(e));r.header("Content-Type","text/html"),r.status(200).send('<html><head><script type="text/javascript">sessionStorage.removeItem("'+p+'");window.location.href = "https://'+t.rta+"/v2/logout/?returnTo="+n+"&client_id="+n+'";<\/script></head></html>')}),d.get("/.well-known/oauth2-client-configuration",function(e,r){r.header("Content-Type","application/json"),r.status(200).send({redirect_uris:[c.getBaseUrl(e)+a+"/login/callback"],client_name:t.clientName,post_logout_redirect_uris:[c.getBaseUrl(e)]})}),d}},function(t,e,r){t.exports.dashboardAdmins=r(54)},function(t,e,r){const n=r(3),o=r(12);t.exports.createServer=function(t){const e=n.createServer(t);var r=null;return o.fromExpress(function(t,n){return r||(r=e(t.webtaskContext)),r(t,n)})}},function(t,e,r){const n=r(26),o=r(5),i=r(22),s=r(2),u=r(25),c=r(8),a=r(1).ArgumentError,p=r(1).ManagementApiError,d=function(t,e,r){return new s(function(n,o){c.post("https://"+t+"/oauth/token").send({audience:"https://"+t+"/api/v2/",client_id:e,client_secret:r,grant_type:"client_credentials"}).set("Accept","application/json").end(function(t,r){return t&&401===t.status?o(new p("unauthorized","Invalid credentials for "+e,t.status)):t&&r&&r.body&&r.body.error?o(new p(r.body.error,r.body.error_description||r.body.error,t.status)):t?o(t):r.ok&&r.body.access_token?n(r.body.access_token):o(new p("unknown_error","Unknown error from Management Api or no access token was provided: "+(r.text||r.status)))})})},f=s.promisify(u({load:function(t,e,r,n){d(t,e,r).then(function(t){return n(null,t)}).catch(function(t){return n(t)})},hash:function(t,e,r){return t+"-"+e+"-"+r},itemMaxAge:function(t,e,r,n){try{const i=o.decode(n),s=new Date(0);s.setUTCSeconds(i.exp);const u=(new Date).valueOf();return s.valueOf()-u-1e4}catch(t){return 1e3}},max:100,maxAge:n("1h")}));t.exports.getAccessToken=d,t.exports.getAccessTokenCached=f,t.exports.getClient=function(t){if(null===t||void 0===t)throw new a("An options object must be provided");if(null===t.domain||void 0===t.domain)throw new a("An options object must contain the domain");if("string"!=typeof t.domain||0===t.domain.length)throw new a("The provided domain is invalid: "+t.domain);if(t.accessToken){if("string"!=typeof t.accessToken||0===t.accessToken.length)throw new a("The provided accessToken is invalid");return s.resolve(new i.ManagementClient({domain:t.domain,token:t.accessToken}))}if(null===t.clientId||void 0===t.clientId)throw new a("An options object must contain the clientId");if("string"!=typeof t.clientId||0===t.clientId.length)throw new a("The provided clientId is invalid: "+t.clientId);if(null===t.clientSecret||void 0===t.clientSecret)throw new a("An options object must contain the clientSecret");if("string"!=typeof t.clientSecret||0===t.clientSecret.length)throw new a("The provided clientSecret is invalid");return f(t.domain,t.clientId,t.clientSecret).then(function(e){return new i.ManagementClient({domain:t.domain,token:e})})}},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new c("Must provide a storage context");this.storageContext=t,this.queue=u(),this.options=e||{concurrentWrites:!0}}const o=r(4),i=r(27),s=r(20),u=r(68),c=r(1).ArgumentError,a=r(1).NotFoundError,p=r(1).ValidationError,d=function(t,e){return t.read(e).then(function(t){return t[e]=t[e]||[],t})},f=function(t,e){const r={retries:10,factor:2,minTimeout:100,maxTimeout:1/0,randomize:!1};return function(){return s(function(r){return e().catch(function(e){if((t.writeRetryCondition||function(){return!1})(e))return r(e);throw e})},r)}};n.prototype.write=function(t,e){const r=f(t,e);if(this.options.concurrentWrites)return r();const n=this.queue;return new Promise(function(t,e){n(r,function(r,n){return r?e(r):t(n)})})},n.prototype.getAll=function(t){return d(this.storageContext,t).then(function(e){return e[t]})},n.prototype.get=function(t,e){return this.getAll(t).then(function(r){const n=o.find(r,function(t){return t._id===e});return n||Promise.reject(new a("The record "+e+" in "+t+" does not exist."))})},n.prototype.create=function(t,e){const r=this.storageContext;return this.write(r,function(){return d(r,t).then(function(n){return e._id||(e._id=i.v4()),o.findIndex(n[t],function(t){return t._id===e._id})>-1?Promise.reject(new p("The record "+e._id+" in "+t+" already exists.")):(n[t].push(e),r.write(n).then(function(){return e}))})})},n.prototype.update=function(t,e,r,n){const i=this.storageContext;return this.write(i,function(){return d(i,t).then(function(s){const u=o.findIndex(s[t],function(t){return t._id===e});if(u<0&&!n)throw new a("The record "+e+" in "+t+" does not exist.");const c=o.extend({_id:e},u<0?{}:s[t][u],r);return u<0?s[t].push(c):s[t][u]=c,i.write(s).then(function(){return c})})})},n.prototype.delete=function(t,e){const r=this.storageContext;return this.write(r,function(){return d(r,t).then(function(n){const i=o.findIndex(n[t],function(t){return t._id===e});return!(i<0)&&(n[t].splice(i,1),r.write(n).then(function(){return!0}))})})},t.exports=n},function(t,e){t.exports=function(){const t={};var e=null;const r=function(r){if(t&&t[r])return t[r];if(!e)throw new Error("A configuration provider has not been set");return e(r)};return r.setProvider=function(t){e=t},r.setValue=function(e,r){t[e]=r},r}},function(t,e,r){const n=r(16);t.exports.createServer=function(t){var e=null;return function(r){if(!e){const o=n.fromWebtaskContext(r);e=t(o,r.storage)}return e}}},function(t,e,r){function n(t){Error.call(this,t),this.name="ArgumentError",this.message=t,this.status=400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t){Error.call(this,t),this.name="ForbiddenError",this.message=t,this.status=403}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t,e){Error.call(this,t),this.name="HookTokenError",this.message=t,this.status=401,this.innerError=e}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t,e,r){Error.call(this,e),this.name="ManagementApiError",this.code=t,this.message=e,this.status=r||400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t){Error.call(this,t),this.name="NotFoundError",this.message=t,this.status=404}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t){Error.call(this,t),this.name="UnauthorizedError",this.message=t,this.status=401}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){function n(t){Error.call(this,t),this.name="ValidationError",this.message=t,this.status=400}n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,t.exports=n},function(t,e,r){const n=r(21);t.exports=function(){const t=n.queue(function(t,e){t().then(function(t){e(null,t)}).catch(function(t){e(t)})},1);return t.push.bind(t)}},function(t,e,r){function n(t,e,r){if(null===t||void 0===t)throw new c("Must provide a valid domain");if("string"!=typeof t||0===t.length)throw new c("The provided rta is invalid: "+t);if(0===t.indexOf("https://")&&(t=t.replace("https://","")),null===e||void 0===e)throw new c("Must provide a valid domain");if("string"!=typeof e||0===e.length)throw new c("The provided domain is invalid: "+e);if(null===r||void 0===r)throw new c("Must provide a valid clientId");if("string"!=typeof r||0===r.length)throw new c("The provided clientId is invalid: "+r);this.options={rta:t,domain:e,clientId:r},this.jwksClient=s({cache:!0,rateLimit:!0,jwksRequestsPerMinute:10,jwksUri:"https://"+t+"/.well-known/jwks.json"}),this.managementApiAudience="https://"+e+"/api/v2/"}const o=r(5),i=r(2),s=r(11),u=r(9),c=r(1).ArgumentError,a=r(1).UnauthorizedError,p=r(1).ValidationError;n.prototype.createAuthorizeUrl=function(t){if(null===t||void 0===t)throw new c("Must provide the options");if(null===t.redirectUri||void 0===t.redirectUri)throw new c("Must provide the redirectUri");if(null===t.nonce||void 0===t.nonce)t.nonce=u.randomBytes(16).toString("hex");else if("string"!=typeof t.nonce||0===t.nonce.length)throw new c("The provided nonce is invalid: "+t.nonce);if("string"!=typeof t.redirectUri||0===t.redirectUri.length)throw new c("The provided redirectUri is invalid: "+t.redirectUri);if(void 0!==t.state&&("string"!=typeof t.state||0===t.state.length))throw new c("The provided state is invalid: "+t.state);var e="openid name email";t.scopes&&t.scopes.length&&(e+=" "+t.scopes);var r=["https://"+this.options.rta+"/authorize","?client_id="+encodeURIComponent(this.options.clientId),"&response_type=token id_token","&response_mode=form_post","&scope="+encodeURIComponent(e),"&expiration="+(t.expiration||36e3),"&redirect_uri="+encodeURIComponent(t.redirectUri),"&audience="+encodeURIComponent(this.managementApiAudience),"&nonce="+encodeURIComponent(t.nonce)];return t.state&&r.push("&state="+encodeURIComponent(t.state)),r.join("")},n.prototype.validateToken=function(t,e,r){const n=this;return new i(function(t,i){const s=o.decode(r,{complete:!0});return null==s?i(new p("Unable to decoded the token.")):n.jwksClient.getSigningKey(s.header.kid,function(s,u){if(s)return i(s);const c=u.publicKey||u.rsaPublicKey;return o.verify(r,c,{algorithms:["RS256"]},function(r,o){return r?i(r):o.iss!=="https://"+n.options.rta+"/"?i(new a("Invalid issuer: "+o.iss)):o&&(o.aud===e||Array.isArray(o.aud)&&o.aud.indexOf(e)>-1)?t(o):i(new a("Audience mismatch for: "+e))})})})},n.prototype.create=function(t,e,r){if(null===t||void 0===t)return i.reject(new c("Must provide an id_token"));if("string"!=typeof t||0===t.length)return i.reject(new c("The provided id_token is invalid: "+t));if(null===e||void 0===e)return i.reject(new c("Must provide an access_token"));if("string"!=typeof e||0===e.length)return i.reject(new c("The provided access_token is invalid: "+e));if(null===r||void 0===r)return i.reject(new c("Must provide the options"));if(null===r.secret||void 0===r.secret)return i.reject(new c("Must provide the secret"));if("string"!=typeof r.secret||0===r.secret.length)return i.reject(new c("The provided secret is invalid: "+r.secret));if(null===r.audience||void 0===r.audience)return i.reject(new c("Must provide the audience"));if("string"!=typeof r.audience||0===r.audience.length)return i.reject(new c("The provided audience is invalid: "+r.audience));if(null===r.issuer||void 0===r.issuer)return i.reject(new c("Must provide the issuer"));if("string"!=typeof r.issuer||0===r.issuer.length)return i.reject(new c("The provided issuer is invalid: "+r.issuer));const n=this;return i.all([n.validateToken(n.options.clientId,n.options.clientId,t),n.validateToken(n.options.clientId,n.managementApiAudience,e)]).then(function(t){if(t[1].azp!==n.options.clientId)return i.reject(new a("The access_token's azp does not match the id_token"));if(t[0].sub!==t[1].sub)return i.reject(new a("Subjects don't match"));const s={sub:t[0].sub,email:t[0].email,exp:t[0].exp,access_token:e};return o.sign(s,r.secret,{algorithm:"HS256",issuer:r.issuer,audience:r.audience})})},t.exports=n},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new u("Must provide the path to the file");if("string"!=typeof t||0===t.length)throw new u("The provided path is invalid: "+t);e=e||{mergeWrites:!0},this.path=t,this.mergeWrites=e.mergeWrites,this.defaultData=e.defaultData||{}}const o=r(4),i=r(24),s=r(2),u=r(1).ArgumentError;n.prototype.read=function(){const t=this;return new s(function(e,r){i.readFile(t.path,"utf8",function(n,o){if(n)return"ENOENT"===n.code?e(t.defaultData):r(n);try{return e(o&&o.length?JSON.parse(o):t.defaultData)}catch(t){return r(t)}})})},n.prototype.write=function(t){const e=this;var r=s.resolve(t);return e.mergeWrites&&(r=r.then(function(t){return e.read().then(function(e){return o.extend({},e,t)})})),r.then(function(t){return new s(function(r,n){try{return i.writeFile(e.path,JSON.stringify(t,null,2),"utf8",function(t){return t?n(t):r()})}catch(t){return n(t)}})})},t.exports=n},function(t,e,r){t.exports.FileStorageContext=r(70),t.exports.WebtaskStorageContext=r(72)},function(t,e,r){function n(t,e){if(null===t||void 0===t)throw new i("Must provide the Webtask storage object");e=e||{force:1},this.storage=t,this.options=e,this.defaultData=e.defaultData||{}}const o=r(2),i=r(1).ArgumentError;n.prototype.read=function(){const t=this;return new o(function(e,r){t.storage.get(function(n,o){return n?r(n):e(o||t.defaultData)})})},n.prototype.write=function(t){const e=this;return new o(function(r,n){e.storage.set(t,e.options,function(t){return t?n(t):r()})})},n.prototype.writeRetryCondition=function(t){return 409===t.code},t.exports=n},function(t,e,r){const n=r(5),o=r(1).HookTokenError;t.exports=function(t,e,r,i,s){if(!s)throw new o("Hook token missing");try{return n.verify(s,i,{audience:e+r,issuer:"https://"+t}),!0}catch(t){throw new o("Invalid hook token",t)}}},function(t,e,r){"use strict";var n=(r(4),r(10)),o=r(93),i=r(7).middlewares,s=r(6),u=r(78),c=r(77);t.exports=function(t){var e=n.Router();return e.use(i.authenticateAdmins({credentialsRequired:!0,secret:s("EXTENSION_SECRET"),audience:"urn:user-import-export-extension",baseUrl:s("PUBLIC_WT_URL")||s("WT_URL"),onLoginSuccess:function(t,e,r){r()}})),e.post("/jobs/import",function(e,r,n){var i=new o.IncomingForm;i.keepExtensions=!0,i.parse(e,function(o,i,s){if(o)return n(o);c.usersImport(i.connection_id,s.users,t,e.user.access_token).then(function(t){return r.json(t)}).catch(n)})}),e.post("/jobs/export",function(e,r,n){c.usersExport(e.body,t,e.user.access_token).then(function(t){return r.json(t)}).catch(n)}),e.get("/jobs/:id",function(e,r,n){c.check(e.params.id,t,e.user.access_token).then(function(t){return r.json(t)}).catch(n)}),e.get("/jobs/:id/report",function(t,e,r){c.report(t.params.id,t.user.access_token).then(function(t){return e.json(t)}).catch(r)}),e.get("/connections",function(t,e,r){u.getConnections(t.query.strategy||null,t.user.access_token).then(function(t){return e.json(t)}).catch(r)}),e.get("/users",function(t,e,r){u.getUsersCount(t.query.connection||null,t.user.access_token).then(function(t){return e.json(t)}).catch(r)}),e.get("/history",function(e,r,n){t.read().then(function(t){return r.json(t)}).catch(n)}),e}},function(t,e,r){"use strict";var n=r(92),o=r(6),i=r(7).urlHelpers;t.exports=function(){var t='\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <title>User Import / Export Dashboard</title>\n      <meta charset="UTF-8" />\n      <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n      <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n      <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/2.0.1/lib/logos/img/favicon.png">\n      <meta name="viewport" content="width=device-width, initial-scale=1">\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css">\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.973/css/index.min.css">\n      <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/3.8.4/index.css">\n      <% if (assets.version) { %>\n        <link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/auth0-user-import-export/assets/auth0-user-import-export.ui.<%= assets.version %>.css">\n      <% } %>\n    </head>\n    <body>\n      <div id="app"></div>\n      <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n      <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.973/components/ZeroClipboard/ZeroClipboard.js"><\/script>\n      <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.973/js/bundle.js"><\/script>\n      <% if (assets.app) { %><script type="text/javascript" src="<%= assets.app %>"><\/script><% } %>\n      <% if (assets.version) { %>\n      <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-user-import-export/assets/auth0-user-import-export.ui.vendors.<%= assets.version %>.js"><\/script>\n      <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-user-import-export/assets/auth0-user-import-export.ui.<%= assets.version %>.js"><\/script>\n      <% } %>\n    </body>\n    </html>\n  ';return function(e,r){var s={HOSTING_ENV:o("HOSTING_ENV"),CLIENT_VERSION:"2.4.6",AUTH0_DOMAIN:o("AUTH0_DOMAIN"),BASE_URL:i.getBaseUrl(e),BASE_PATH:i.getBasePath(e)};0!==s.BASE_PATH.indexOf("/")&&(s.BASE_PATH="/"+s.BASE_PATH);return r.send(n.render(t,{config:s,assets:{version:"2.4.6"}}))}}},function(t,e,r){"use strict";var n=r(4);t.exports=function(t,e){return e.read().then(function(r){r=r||{},r.jobs=r.jobs||[];var o={id:t.id,type:t.type,date:t.date||new Date,status:t.status||"pending",summary:t.summary||{}},i=n.findIndex(r.jobs,{id:o.id});return i<0?r.jobs.push(o):(r.jobs[i].status=o.status,r.jobs[i].summary=o.summary),r.jobs.length>20&&(r.jobs=n.drop(r.jobs,r.jobs.length-20)),e.write(r).then(function(){return t})})}},function(t,e,r){"use strict";var n=r(2),o=r(8),i=r(76),s=r(6);t.exports={usersImport:function(t,e,r,u){var c="https://"+s("AUTH0_DOMAIN")+"/api/v2/jobs/users-imports";return new n(function(n,s){o.post(c).set("accept","json").set("Authorization","Bearer "+u).field("connection_id",t).attach("users",e.path).end(function(t,e){if(t||!e)return s(t||"Unknown error");if(e.status>=300)return s(e.error||e.body||e);var o={id:e.body.id,type:"import"};return i(o,r).then(function(){return n(e.body)})})})},usersExport:function(t,e,r){var u="https://"+s("AUTH0_DOMAIN")+"/api/v2/jobs/users-exports";return new n(function(n,s){o.post(u).send(t).set("accept","json").set("Authorization","Bearer "+r).end(function(t,r){if(t||!r)return s(t||"Unknown error");if(r.status>=300)return s(r.error||r.body||r);var o={id:r.body.id,type:"export"};return i(o,e).then(function(){return n(r.body)})})})},check:function(t,e,r){var u="https://"+s("AUTH0_DOMAIN")+"/api/v2/jobs/"+t;return new n(function(n,s){o.get(u).set("accept","json").set("Authorization","Bearer "+r).end(function(r,o){if(r||!o)return s(r||"Unknown error");if(o.status>=300)return s(o.error||o.body||o);var u={id:t,status:o.body.status,summary:o.body.summary};return i(u,e).then(function(){return n(o.body)})})})},report:function(t,e){var r="https://"+s("AUTH0_DOMAIN")+"/api/v2/jobs/"+t+"/errors";return new n(function(t,n){o.get(r).set("accept","json").set("Authorization","Bearer "+e).end(function(e,r){return e||!r?n(e||"Unknown error"):r.status>=300?n(r.error||r.body||r):t(204===r.status?["Failed to parse users file when importing users."]:r.body)})})}}},function(t,e,r){"use strict";var n=r(2),o=r(8),i=r(6),s=function(t,e){return new n(function(r,n){o.get(t).set("accept","json").set("Authorization","Bearer "+e).end(function(t,e){return t?n(t):e.status>=200&&e.status<=300?r(e.body):n(e&&e.error||e)})})},u=function(t,e){var r=[],o="https://"+i("AUTH0_DOMAIN")+"/api/v2/connections",u=0,c=0,a="?per_page=100";t&&(a+="&strategy=auth0");var p=function(){return s(""+o+a+"&page=0&include_totals=true",e).then(function(t){return u=t.total||0,c=Math.ceil(u/100),(t.connections||t||[]).forEach(function(t){return r.push(t)}),null})},d=function(t){return s(""+o+a+"&page="+t,e).then(function(t){return t.forEach(function(t){return r.push(t)}),null})};return function(){return p().then(function(){if(0===u||r.length>=u)return r;for(var t=[],e=1;e<=c;e++)t.push(e);return n.map(t,d,{concurrency:5})})}().then(function(){return r})};t.exports={getUsersCount:function(t,e){var r="https://"+i("AUTH0_DOMAIN")+"/api/v2/users?per_page=1&page=0&include_totals=true&search_engine=v3";return t&&(r+='&q=identities.connection:"'+t+'"'),s(r,e)},getConnections:u}},function(t,e,r){"use strict";var n=r(7),o=r(28),i=r(6),s=r(13),u=n.createServer(function(t,e){return s.info("Starting User Import/Export Extension - Version:","2.4.6"),o(t,e)});t.exports=function(t,e,r){e.x_wt&&e.x_wt.ectx&&e.x_wt.ectx.PUBLIC_WT_URL||!1||i.setValue("PUBLIC_WT_URL",n.urlHelpers.getWebtaskUrl(e)),u(t,e,r)}},function(t,e,r){"use strict";function n(t,e){return function(r,n,o){if(r.cookies)return o();var s=r.headers.cookie,a=!t||Array.isArray(t)?t||[]:[t];if(r.secret=a[0],r.cookies=Object.create(null),r.signedCookies=Object.create(null),!s)return o();r.cookies=c.parse(s,e),0!==a.length&&(r.signedCookies=u(r.cookies,a),r.signedCookies=i(r.signedCookies)),r.cookies=i(r.cookies),o()}}function o(t){if("string"==typeof t&&"j:"===t.substr(0,2))try{return JSON.parse(t.slice(2))}catch(t){return}}function i(t){for(var e,r,n=Object.keys(t),i=0;i<n.length;i++)e=n[i],(r=o(t[e]))&&(t[e]=r);return t}function s(t,e){if("string"==typeof t){if("s:"!==t.substr(0,2))return t;for(var r=!e||Array.isArray(e)?e||[]:[e],n=0;n<r.length;n++){var o=a.unsign(t.slice(2),r[n]);if(!1!==o)return o}return!1}}function u(t,e){for(var r,n,o,i=Object.keys(t),u=Object.create(null),c=0;c<i.length;c++)n=i[c],o=t[n],r=s(o,e),o!==r&&(u[n]=r,delete t[n]);return u}var c=r(81),a=r(91);t.exports=n,t.exports.JSONCookie=o,t.exports.JSONCookies=i,t.exports.signedCookie=s,t.exports.signedCookies=u},function(t,e,r){"use strict";function n(t,e){if("string"!=typeof t)throw new TypeError("argument str must be a string");for(var r={},n=e||{},o=t.split(c),u=n.decode||s,a=0;a<o.length;a++){var p=o[a],d=p.indexOf("=");if(!(d<0)){var f=p.substr(0,d).trim(),h=p.substr(++d,p.length).trim();'"'==h[0]&&(h=h.slice(1,-1)),void 0==r[f]&&(r[f]=i(h,u))}}return r}function o(t,e,r){var n=r||{},o=n.encode||u;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!a.test(t))throw new TypeError("argument name is invalid");var i=o(e);if(i&&!a.test(i))throw new TypeError("argument val is invalid");var s=t+"="+i;if(null!=n.maxAge){var c=n.maxAge-0;if(isNaN(c))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(c)}if(n.domain){if(!a.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!a.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite){switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return s}function i(t,e){try{return e(t)}catch(e){return t}}e.parse=n,e.serialize=o;var s=decodeURIComponent,u=encodeURIComponent,c=/; */,a=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(t,e,r){"use strict";function n(t,e,r){var n,o=t instanceof Error?t:new Error(t);if("object"==typeof e?r=e:null!=e&&(o.code=e),r)for(n in r)o[n]=r[n];return o}t.exports=n},function(t,e){t.exports={title:"User Import / Export",name:"auth0-user-import-export",version:"2.4.6",preVersion:"2.4.4",author:"auth0",useHashName:!1,description:"This extension allows you to import/export users from/to your account.",type:"application",category:"end_user",logoUrl:"https://cdn.rawgit.com/auth0/auth0-user-import-export-extension/master/assets/logo.svg",initialUrlPath:"/login",docsUrl:"https://auth0.com/docs/extensions/user-import-export",repository:"https://github.com/auth0/auth0-user-import-export-extension",keywords:["auth0","extension"],auth0:{scopes:"create:users read:users read:connections create:passwords_checking_job"},environments:{appliance:{version:"1.7.0",preVersion:"1.7.0",auth0:{scopes:"create:users read:users read:connections"}}}}},function(t,e){function r(t){this.message=t}function n(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,s=0,u=0,c="";i=e.charAt(u++);~i&&(n=s%4?64*n+i:i,s++%4)?c+=String.fromCharCode(255&n>>(-2*s&6)):0)i=o.indexOf(i);return c}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.name="InvalidCharacterError",t.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||n},function(t,e,r){function n(t){return decodeURIComponent(o(t).replace(/(.)/g,function(t,e){var r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}var o=r(84);t.exports=function(t){var e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw"Illegal base64url string!"}try{return n(e)}catch(t){return o(e)}}},function(t,e,r){function n(t){var e=function(){return e.called?e.value:(e.called=!0,e.value=t.apply(this,arguments))};return e.called=!1,e}function o(t){var e=function(){if(e.called)throw new Error(e.onceError);return e.called=!0,e.value=t.apply(this,arguments)},r=t.name||"Function wrapped with `once`";return e.onceError=r+" shouldn't be called more than once",e.called=!1,e}var i=r(97);t.exports=i(n),t.exports.strict=i(o),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(t,e,r){t.exports=r(88)},function(t,e,r){var n=r(89);e.operation=function(t){var r=e.timeouts(t);return new n(r,{forever:t&&t.forever,unref:t&&t.unref})},e.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var n=[],o=0;o<e.retries;o++)n.push(this.createTimeout(o,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(o,e)),n.sort(function(t,e){return t-e}),n},e.createTimeout=function(t,e){var r=e.randomize?Math.random()+1:1,n=Math.round(r*e.minTimeout*Math.pow(e.factor,t));return n=Math.min(n,e.maxTimeout)},e.wrap=function(t,r,n){if(r instanceof Array&&(n=r,r=null),!n){n=[];for(var o in t)"function"==typeof t[o]&&n.push(o)}for(var i=0;i<n.length;i++){var s=n[i],u=t[s];t[s]=function(){var n=e.operation(r),o=Array.prototype.slice.call(arguments),i=o.pop();o.push(function(t){n.retry(t)||(t&&(arguments[0]=n.mainError()),i.apply(this,arguments))}),n.attempt(function(){u.apply(t,o)})},t[s].options=r}}},function(t,e){function r(t,e){"boolean"==typeof e&&(e={forever:e}),this._timeouts=t,this._options=e||{},this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}t.exports=r,r.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},r.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;this._errors.push(t);var e=this._timeouts.shift();if(void 0===e){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),e=this._timeouts.shift()}var r=this,n=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),this._options.unref&&r._timeout.unref()),r._fn(r._attempts)},e);return this._options.unref&&n.unref(),!0},r.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._fn(this._attempts)},r.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},r.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},r.prototype.start=r.prototype.try,r.prototype.errors=function(){return this._errors},r.prototype.attempts=function(){return this._attempts},r.prototype.mainError=function(){if(0===this._errors.length)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var o=this._errors[n],i=o.message,s=(t[i]||0)+1;t[i]=s,s>=r&&(e=o,r=s)}return e}},function(t,e){t.exports=require("body-parser")},function(t,e){t.exports=require("cookie-signature@1.0.6")},function(t,e){t.exports=require("ejs")},function(t,e){t.exports=require("formidable")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("url")},function(t,e){t.exports=require("winston")},function(t,e){t.exports=require("wrappy@1.0.1")}]);